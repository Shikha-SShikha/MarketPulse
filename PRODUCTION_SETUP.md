# Production Setup Guide

Your Render deployment is live but needs initial data. Follow these steps to populate the production database.

## Step 1: Get Your Production Credentials

1. **Go to Render Dashboard**: https://dashboard.render.com
2. **Select `stm-intelligence-api` service**
3. **Click on "Environment" tab**
4. **Find and copy the `CURATOR_TOKEN` value** (it was auto-generated by Render)

The token will look something like: `rnd_aBcDeFgHiJkLmNoPqRsTuVwXyZ123456`

## Step 2: Get Your API URL

From the Render dashboard:
1. Go to your `stm-intelligence-api` service
2. Copy the URL (should be something like `https://stm-intelligence-api.onrender.com`)

## Step 3: Initialize Production Database

Run the initialization script:

```bash
cd /home/shikha/Main/Coding/Prototype\ 3
./scripts/init_production.sh \
  https://stm-intelligence-api.onrender.com \
  your-production-curator-token-here
```

**Replace:**
- `https://stm-intelligence-api.onrender.com` with your actual API URL
- `your-production-curator-token-here` with the token from Step 1

This script will:
- ✅ Create 6 data sources (Nature, Science, PLOS, Scholarly Kitchen, CSE, STM Publishing News)
- ✅ Trigger initial signal collection
- ✅ Populate your production database

## Step 4: Access Your Production Dashboard

1. **Open your frontend**: https://stm-intelligence-frontend.onrender.com
2. **Click "Admin Login"**
3. **Enter your production CURATOR_TOKEN** (from Step 1)
4. **You should now see signals in the dashboard!**

## What Gets Created

### Data Sources (6 total):
1. **Nature News & Comment** (RSS, High confidence)
2. **Science News** (RSS, High confidence)
3. **PLOS Blog** (RSS, Medium confidence)
4. **Scholarly Kitchen** (Web scraper, High confidence)
5. **CSE Science Editor** (RSS, High confidence)
6. **STM Publishing News** (RSS, High confidence)

### Initial Collection:
- The script triggers an immediate signal collection
- You should see 100-200 signals appear within a few minutes

## Automated Collection Schedule

Your production deployment is configured to automatically collect signals:
- **Schedule**: Daily at 9:00 AM UTC
- **Status**: Enabled (`ENABLE_AUTOMATED_COLLECTION=true`)
- You can manually trigger collection anytime via: **Admin → Data Sources → "Trigger Collection"**

## Troubleshooting

### "No signals appearing"
1. Check if data sources were created: Go to **Data Sources** page
2. Manually trigger collection: Click **"Trigger Collection"** button
3. Check API logs in Render dashboard for errors

### "Authentication failed"
- Make sure you're using the **production** CURATOR_TOKEN from Render
- Don't use the dev token (`dev-token-change-in-production`)

### "Collection taking too long"
- First collection can take 2-3 minutes (Render free tier spins down after inactivity)
- Subsequent collections are faster (~30 seconds)

### "OPENAI_API_KEY not set" warning
- Weekly brief generation requires OpenAI API key
- Signal collection works without it
- To enable briefs: Add `OPENAI_API_KEY` in Render environment variables

## Next Steps

After initialization:

1. **Review Signals**: Go to **Signals** page to see collected intelligence
2. **Manage Sources**: Go to **Data Sources** to add/remove sources
3. **Generate Brief**: Click **Generate Weekly Brief** (requires OpenAI API key)
4. **Set up OpenAI** (optional): Add `OPENAI_API_KEY` in Render for AI summaries

## Production URLs

- **Frontend**: https://stm-intelligence-frontend.onrender.com
- **Backend API**: https://stm-intelligence-api.onrender.com
- **API Health Check**: https://stm-intelligence-api.onrender.com/health
- **API Docs**: https://stm-intelligence-api.onrender.com/docs

## Security Notes

⚠️ **Important:**
- Never commit your production `CURATOR_TOKEN` to git
- Keep it secure (it's your admin password)
- You can regenerate it in Render dashboard if compromised
- The token in `backend/.env` (`dev-token-change-in-production`) is only for local development
